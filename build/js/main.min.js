"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var ready=function(){"undefined"!=typeof autosize&&autosize(document.querySelectorAll("textarea")),paintRating(),document.querySelector("[data-expander]")&&expander.init(),document.querySelector("[data-accordion]")&&accordion.init(),document.querySelector("[data-message]")&&message.init();[].concat(_toConsumableArray(document.querySelectorAll("[data-tabs-title]"))).forEach(function(e){return tabControl.init(e)}),document.querySelector("[data-minimizable]")&&minimizeTexts([].concat(_toConsumableArray(document.querySelectorAll("[data-minimizable]")))),document.querySelector("[data-cart-counter]")&&cartCounter.init(),document.querySelector("[data-summary-counter]")&&summaryCounter.init(),document.querySelector("[data-choose-cities]")&&citiesChooser.init(),document.querySelector(".lang-switcher")&&langSwitcher.init()};document.addEventListener("DOMContentLoaded",ready);var accordion={init:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.querySelectorAll("[data-accordion]");[].concat(_toConsumableArray(e)).forEach(function(e){e.querySelector(".accordion-title").addEventListener("click",function(){return accordion.toggle(e)})})},toggle:function(e){if(e.dataset.accordion&&!e.classList.contains("_is-open")){[].concat(_toConsumableArray(document.querySelectorAll('[data-accordion="'+e.dataset.accordion+'"]'))).forEach(function(e){return accordion.close(e)})}e.classList.toggle("_is-open");var t=e.querySelector(".accordion-content");t.hidden=!t.hidden;var n=e.querySelector(".accordion-title");n.dataset.show&&(n.innerHTML=e.classList.contains("_is-open")?n.dataset.hide:n.dataset.show);var r=[].concat(_toConsumableArray(e.querySelectorAll("[data-accordion]")));r&&r.forEach(function(e){return accordion.close(e)})},close:function(e){e.classList.remove("_is-open"),e.querySelector(".accordion-content").hidden=!0;var t=e.querySelector(".accordion-title");t.dataset.show&&(t.innerHTML=t.dataset.hide)}},expander={init:function(){[].concat(_toConsumableArray(document.querySelectorAll("[data-expander]"))).forEach(function(e){[].concat(_toConsumableArray(e.querySelectorAll("[data-expander-item]"))).forEach(function(t){t.addEventListener("click",function(){return expander.toggle(t,e)})})})},toggle:function(e,t){e.classList.contains("_is-active")||"a"===event.target.tagName.toLowerCase()||(t.querySelector("._is-active[data-expander-item]").classList.remove("_is-active"),e.classList.add("_is-active"))}},message={init:function(){[].concat(_toConsumableArray(document.querySelectorAll("[data-message]"))).forEach(function(e){e.addEventListener("click",function(){return message.toggle(e)})})},toggle:function(e){e.classList.toggle("_is-minimized");var t=e.querySelector("time"),n=t.dateTime.split(/[- :]/).map(function(e){return parseInt(e,10)}),r=new Date(n[0],n[1]-1,n[2],n[3],n[4]);e.classList.contains("_is-minimized")?t.innerHTML=r.toLocaleString("ru-RU",{month:"short",day:"numeric"}):t.innerHTML=r.toLocaleString("ru-RU",{weekday:"long",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}},paintRating=function(){[].concat(_toConsumableArray(document.querySelectorAll(".rating[data-value]"))).forEach(function(e){e.style.width=15*e.dataset.max+"px",e.childNodes[0].style.width=e.dataset.value/e.dataset.max*100+"%"})},tabControl={init:function(e){[].concat(_toConsumableArray(e.querySelectorAll("[data-tab]"))).forEach(function(t){t.addEventListener("click",function(){return tabControl.switch(t,e)})})},switch:function(e,t){var n="_is-active";if(!e.classList.contains(n)){var r=t.dataset.tabsTitle,a=document.querySelector("[data-tabs-content="+r+"]"),i=t.querySelector("."+n);i.classList.remove(n),e.classList.add(n),a.querySelector('[data-tab="'+i.dataset.tab+'"]').hidden=!0,a.querySelector('[data-tab="'+e.dataset.tab+'"]').hidden=!1,a.querySelector("._is-minimized[data-minimizable]")&&minimizeTexts([].concat(_toConsumableArray(a.querySelectorAll("._is-minimized[data-minimizable]"))))}}},filePreview={show:function(e){var t=e.target,n=t.files[0],r=new FileReader;r.onload=function(e){t.nextElementSibling.style.backgroundImage="url("+e.target.result+")",t.classList.add("_is-chosen")},r.readAsDataURL(n)},remove:function(e){var t=document.getElementById(e);t.value="",t.classList.remove("_is-chosen"),t.nextElementSibling.style.backgroundImage="none"}},modal={open:function(e){event&&event.preventDefault();var t=document.querySelector(e);t.classList.add("_is-active");var n=t.querySelector(".modal__overlay"),r=t.querySelector(".modal__close");n.onclick=r.onclick=function(){return modal.close(e)},document.body.classList.add("_is-fixed")},close:function(e){document.querySelector(e).classList.remove("_is-active"),document.body.classList.remove("_is-fixed")}},operatingTime={save:function(){var e=document.querySelector(".operating-time-wrapper");if(e){var t=void 0;if(e.hasChildNodes())t=e.querySelector(".registration__operating-time");else{var n=document.getElementById("operating-time-template").content.querySelector(".registration__operating-time");t=n.cloneNode(!0)}var r=document.getElementById("operating-time"),a=[].concat(_toConsumableArray(r.querySelectorAll("input"))),i=[].concat(_toConsumableArray(t.querySelectorAll("th")));if(a.forEach(function(e){var n=t.querySelector('[data-id="'+e.dataset.id+'"]'),r=e.value.trim();n.innerHTML=r;var a=e.dataset.id.substr(e.dataset.id.length-1);r?(n.parentNode.classList.remove("_is-empty"),i[a-1].classList.remove("day-off")):(n.parentNode.classList.add("_is-empty"),e.dataset.id.includes("work")&&i[a-1].classList.add("day-off"))}),!e.hasChildNodes()){e.appendChild(t);document.getElementById("set-operating-time").remove();var o=document.getElementById("edit-operating-time").content.querySelector("button").cloneNode(!0);e.appendChild(o)}modal.close("#operating-time")}}},registrationDelivery={toggle:function(){var e=document.querySelector(".registration-delivery-wrapper");e.hasChildNodes()?registrationDelivery.clear(e):registrationDelivery.enable(e)},clear:function(e){e.innerHTML=""},enable:function(e){var t=document.getElementById("registration-delivery-template").content.querySelector("div").cloneNode(!0);e.appendChild(t),this.addItem()},addItem:function(){var e=document.querySelector(".registration-delivery-wrapper"),t=document.getElementById("delivery-item-template").content.querySelector("div").cloneNode(!0),n=e.querySelector(".registration__add-delivery");n.parentNode.insertBefore(t,n)}},checkForm=function(e){var t=!0;[].concat(_toConsumableArray(e.querySelectorAll("[required]"))).forEach(function(e){e.checkValidity()||(t=!1)});var n=!e.querySelector(".form__error");e.querySelector('[type="submit"]').disabled=!t||!n},sidePanel={toggle:function(){var e=[].concat(_toConsumableArray(document.querySelectorAll(".grid__column_side-panel")));e.forEach(function(e){e.classList.toggle("_is-minimized")}),e[0].classList.contains("_is-minimized")&&sidePanel.closeAccordion()},closeAccordion:function(){var e=document.querySelector(".side-panel__item._is-open");e&&accordion.close(e)}},categories={open:function(e){event.currentTarget.disabled=!0,document.querySelector(e).classList.add("categories__list_full")},toggle:function(e){var t=document.querySelector(e);t.classList.toggle("categories__list_full");var n=event.currentTarget;n.dataset.show&&(n.innerHTML=t.classList.contains("categories__list_full")?n.dataset.hide:n.dataset.show)}},showMore={toggle:function(e){var t=document.querySelector(e),n=event.currentTarget;n.innerHTML=t.classList.contains("_is-expanded")?n.dataset.showMore:n.dataset.showLess,t.classList.toggle("_is-expanded")}},layoutView={toggle:function(e){event.currentTarget.classList.contains("_is-active")||(document.querySelector(".layout-view__layout-type_list").classList.toggle("_is-active"),document.querySelector(".layout-view__layout-type_grid").classList.toggle("_is-active"),document.querySelector(e).classList.toggle("_list-view"),document.querySelector(e).classList.toggle("_grid-view"))}},minimizeTexts=function(e){e.forEach(function(e){var t=e.querySelector(".product-sheet__expand-caption");e.scrollHeight&&(e.scrollHeight>e.clientHeight?(e.classList.add("_is-minimized"),t.addEventListener("click",function(){e.classList.remove("_is-minimized"),t.remove()})):(e.classList.remove("_is-minimized"),t&&t.remove()))})},triggerInput=function(e){var t=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(t)},cartCounter={init:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.querySelectorAll("[data-cart-counter]");[].concat(_toConsumableArray(t)).forEach(function(t){var n=t.querySelector("[data-cart-count]"),r=t.querySelector("[data-cart-increment]"),a=t.querySelector("[data-cart-decrement]"),i={item:t,count:n,increment:r,decrement:a,min:1,max:99};r.addEventListener("click",function(){e.increase(i),triggerInput(n)}),a.addEventListener("click",function(){e.decrease(i),triggerInput(n)}),n.addEventListener("input",function(){return e.checkEdges(i)})})},increase:function(e){e.increment.disabled||e.count.value++},decrease:function(e){e.decrement.disabled||e.count.value--},checkEdges:function(e){+e.count.value===e.max?e.increment.disabled=!0:e.increment.disabled&&(e.increment.disabled=!1),+e.count.value===e.min?e.decrement.disabled=!0:e.decrement.disabled&&(e.decrement.disabled=!1)}},summaryCounter={init:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.querySelectorAll("[data-summary-counter]");[].concat(_toConsumableArray(t)).forEach(function(t){var n=t.dataset.summaryCounter,r=t.querySelector('[data-summary-unit="'+n+'"]'),a=t.querySelector('[data-summary-increment="'+n+'"]'),i=t.querySelector('[data-summary-value="'+n+'"]'),o=[].concat(_toConsumableArray(t.querySelectorAll('[data-summary-summand="'+n+'"]'))),c={item:t,unit:r,increment:a,value:i,summands:o};a?a.addEventListener("input",function(){return e.calculate(c)}):o.forEach(function(t){t.addEventListener("input",function(){return e.calculate(c)})})})},calculate:function(e){var t=void 0;if(t=e.increment?parseInt(e.increment.value,10)*parseFloat(e.unit.innerHTML).toFixed(2):e.summands.map(function(e){return parseFloat(e.value)}).reduce(function(e,t){return e+t},0),e.value.hasAttribute("data-summary-bind")){var n=e.value.dataset.summaryBind,r=e.item.querySelector('[data-summary-binded="'+n+'"]');r.value=t,triggerInput(r)}e.value.innerHTML=t.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}},citiesChooser={init:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.querySelectorAll("[data-choose-cities]");[].concat(_toConsumableArray(t)).forEach(function(t){e.chooserForm=t.querySelector(".choose-city__form"),e.choosenContainer=e.chooserForm.querySelector("fieldset");[].concat(_toConsumableArray(e.chooserForm.querySelectorAll("input"))).forEach(function(t){return t.addEventListener("change",function(){return e.action(t)})})})},action:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.parentNode;if(e.checked){var a=r.cloneNode(!0);this.choosenContainer.appendChild(a),this.choosenContainer.classList.remove("_is-hidden");var i=a.querySelector("input");i.addEventListener("change",function(){return t.action(i)}),e.dataset.id=e.getAttribute("id"),e.removeAttribute("id"),r.classList.add("_is-chosen");var o=r.parentNode;o.querySelector("p:not(._is-chosen)")||o.classList.add("_is-hidden"),"radio"===e.getAttribute("type")&&this.deselect(a.previousElementSibling.querySelector("input"))}else n||this.deselect(e)},deselect:function(e){var t=e.parentNode,n=e.getAttribute("id");t.remove();var r=this.chooserForm.querySelector('[data-id="'+n+'"]');r.setAttribute("id",r.dataset.id),r.removeAttribute("data-id"),r.checked=!1;var a=r.parentNode;a.classList.remove("_is-chosen"),this.choosenContainer.querySelector("p")||this.choosenContainer.classList.add("_is-hidden");a.parentNode.classList.remove("_is-hidden")}},deleteElement=function(e){var t=document.querySelector(e);t&&t.remove()},langSwitcher={init:function(){var e=this,t=document.querySelector(".lang-switcher");t.querySelector(".lang-switcher__button").addEventListener("click",function(){return e.toggle(t)})},toggle:function(e){var t=this;e.classList.toggle("_is-active");e.classList.contains("_is-active")&&document.body.addEventListener("click",function n(r){r.target.parentNode!==e&&(t.close(e),document.body.removeEventListener("click",n))})},close:function(e){e.classList.remove("_is-active")}};